# 📚 17旅游规划助手 - 完整使用教程

这是一份详细的使用教程，涵盖了应用的所有功能、配置方法和使用技巧。

## 📋 目录

- [快速入门](#-快速入门)
- [地图API配置](#️-地图api配置)
- [核心功能详解](#-核心功能详解)
- [高级功能](#-高级功能)
- [使用技巧](#-使用技巧)
- [故障排除](#-故障排除)
- [最佳实践](#-最佳实践)

## 🚀 快速入门

### 第一步：启动应用

1. **直接使用（演示模式）**
   ```
   下载项目文件 → 双击 index.html → 立即开始使用
   ```
   - ✅ 可以使用搜索、列表管理、数据导入导出等基础功能
   - ❌ 地图显示和真实距离计算需要配置API密钥

2. **完整功能配置**
   - 需要配置地图API密钥获得完整功能
   - 推荐使用高德地图API（国内用户）或Google Maps API（海外用户）

### 第二步：了解界面布局

```
┌─────────────────────────────────────────────────────────────┐
│ 🗺️ 17旅游规划助手                    📋方案 📥导入 📤导出 ⚙️设置 │
├─────────────────────┬───────────────────────────────────────┤
│ 🔍 搜索地点          │                                       │
│ [搜索框]             │                                       │
│ 搜索结果列表         │                                       │
│                     │           🗺️ 地图区域                  │
│ 📝 我的游玩列表       │                                       │
│ [控制按钮]           │                                       │
│ 1. 地点一           │                                       │
│ 2. 地点二           │                                       │
│ 📊 路线统计          │                                       │
│                     │                                       │
│ ⏳ 待定列表          │                                       │
└─────────────────────┴───────────────────────────────────────┘
```

## 🗺️ 地图API配置

### 地图服务对比

| 服务商 | 适用场景 | 优势 | 配置难度 |
|--------|----------|------|----------|
| **🟢 高德地图** | 国内用户首选 | 免费额度充足、数据精准、速度快 | ⭐⭐ 简单 |
| **🔵 Google Maps** | 海外用户、全球数据 | 全球覆盖、功能丰富 | ⭐⭐⭐ 中等 |
| **🌐 Bing Maps** | 备选方案 | 微软服务 | ⭐⭐⭐ 中等 |

### 🟢 高德地图API配置（推荐国内用户）

#### 步骤1：注册开发者账号
1. 访问 [高德开放平台](https://console.amap.com/)
2. 点击右上角"注册"按钮
3. 支持手机号、邮箱注册，也可使用第三方账号登录

#### 步骤2：创建应用
1. 登录后进入控制台
2. 点击左侧菜单"应用管理" → "我的应用"
3. 点击"创建新应用"按钮

#### 步骤3：填写应用信息
```
应用名称：17旅游规划助手（或自定义名称）
应用类型：其他
应用分类：生活服务
```

#### 步骤4：添加Key
1. 在创建的应用下点击"添加Key"
2. 填写Key信息：
   ```
   Key名称：旅游规划助手
   服务平台：Web端(JS API)
   ```
3. **重要**：在"绑定服务"中确保勾选：
   - Web服务API
   - Web端(JS API)

#### 步骤5：获取Key
1. 创建成功后，复制生成的"Key"值
2. 这个Key就是您的高德地图API密钥

#### 步骤6：在应用中配置
1. 打开旅游规划助手
2. 点击右上角"⚙️ 设置"
3. 在"🔑 API密钥配置"区域
4. 将复制的Key粘贴到"高德地图API密钥"输入框
5. 点击"保存设置"
6. 🎉 配置完成！

### 🔵 Google Maps API配置

#### 步骤1：创建Google云端项目
1. 访问 [Google Cloud Console](https://console.cloud.google.com/)
2. 点击项目下拉菜单 → "新建项目"
3. 填写项目名称：如"Travel Planner"
4. 点击"创建"

#### 步骤2：启用必需的API
在项目中启用以下API：
```
✅ Maps JavaScript API      - 地图显示
✅ Places API               - 地点搜索
✅ Geocoding API           - 地址解析
✅ Distance Matrix API     - 距离计算
✅ Directions API          - 路线规划
```

**启用方法**：
1. 在云端控制台中，转到"API和服务" → "库"
2. 搜索上述API名称
3. 逐个点击并启用

#### 步骤3：创建API密钥
1. 转到"API和服务" → "凭据"
2. 点击"创建凭据" → "API密钥"
3. 复制生成的API密钥

#### 步骤4：设置API密钥限制（推荐）
1. 点击刚创建的API密钥进行编辑
2. 在"应用程序限制"中选择"HTTP引荐来源网址"
3. 添加您的域名（如：`https://yourdomain.com/*`）
4. 在"API限制"中选择"限制密钥"，选择之前启用的API
5. 保存更改

#### 步骤5：启用计费账户
⚠️ **重要**：Google Maps API需要绑定有效的付款方式：
1. 转到"结算" → "账单"
2. 设置结算账户
3. 💡 **说明**：虽然需要绑定支付方式，但Google提供每月$200的免费额度，正常使用通常不会产生费用

#### 步骤6：在应用中配置
1. 打开旅游规划助手
2. 点击右上角"⚙️ 设置"
3. 将API密钥粘贴到"Google Maps API密钥"输入框
4. 点击"保存设置"

### 🌐 Bing Maps API配置（可选）

#### 获取Bing Maps API密钥
1. 访问 [Bing Maps Dev Center](https://www.bingmapsportal.com/)
2. 使用Microsoft账户登录
3. 点击"My account" → "Create or view keys"
4. 创建新的密钥
5. 在应用设置中配置

## 🎯 核心功能详解

### 1. 🔍 智能地点搜索

#### 搜索类型
- **具体地点搜索**：`北京故宫`、`上海外滩`
- **地点类型搜索**：`博物馆`、`公园`、`餐厅`
- **区域搜索**：`北京 景点`、`上海 美食`

#### 搜索操作
```
1. 在搜索框输入关键词
2. 点击"搜索"按钮或按Enter键
3. 查看搜索结果列表
4. 点击结果项查看详细信息
5. 点击"添加到游玩列表"或"添加到待定列表"
```

#### 搜索结果信息
每个搜索结果显示：
- 📍 **地点名称**：具体的地点名称
- 📮 **详细地址**：完整地址信息
- ⭐ **评分**：用户评分（如有）
- 📋 **简介**：地点描述信息

### 2. 📝 游玩列表管理

#### 添加地点
**方式一：搜索添加**
```
搜索地点 → 查看结果 → 点击"添加到游玩列表"
```

**方式二：地图点击添加**
```
在地图上点击位置 → 自动获取地址信息 → 确认添加
```

**方式三：添加空白地点**
```
点击"添加空白"按钮 → 输入自定义名称 → 添加坐标或地址
```

#### 地点操作
每个游玩点提供5个快捷操作：

| 图标 | 功能 | 说明 |
|------|------|------|
| 📍 | 定位 | 在地图上居中显示该游玩点 |
| 📋 | 复制名称 | 复制游玩点名称到剪贴板 |
| 📄 | 复制地址 | 复制完整地址到剪贴板 |
| 🧭 | 导航到此 | 从当前位置导航到该游玩点 |
| ✕ | 删除 | 从列表中移除该游玩点 |

#### 拖拽排序
```
1. 鼠标悬停在游玩点上
2. 出现拖拽手柄图标
3. 按住并拖拽到目标位置
4. 释放鼠标完成重排序
5. 系统自动重新计算路线
```

### 3. 🚗 路线规划与导航

#### 自动路线计算
- **距离计算**：使用真实道路网络计算驾车距离
- **时间估算**：基于当前交通状况预估行驶时间
- **路线显示**：在地图上显示完整路径，带方向箭头

#### 路线优化
```
1. 添加3个以上地点到游玩列表
2. 点击"优化路线"按钮
3. 系统使用贪心算法重新排序
4. 自动计算最短路径组合
5. 更新列表顺序和地图显示
```

#### 导航集成
**每个路线段支持选择导航平台**：

**🟢 高德地图导航**（推荐国内使用）
- 精准的国内路况信息
- 实时交通状况
- 最优路线推荐

**🔵 Google 地图导航**（推荐海外使用）
- 全球路网覆盖
- 多语言支持
- 街景集成

**导航操作**：
```
1. 在路线段中选择导航平台（高德/谷歌）
2. 点击"🧭 导航"按钮
3. 自动打开对应地图应用
4. 开始导航
```

**🎯 个人导航功能（"导航到此处"）**：
```
1. 点击游玩点右侧的"🧭"按钮
2. 高德地图：直接跳转，让地图应用自动获取"我的位置"
3. Google/Bing地图：系统获取当前位置后跳转
4. 在地图应用中：
   - 起点：自动识别的"我的位置"（实时定位）
   - 终点：目标地点名称和坐标
   - 自动规划最优路线
5. 一键开始导航
```

**✨ 高德地图导航优化（v1.8.2更新）**：
- **🔥 动态定位**：不使用预获取坐标，让高德地图实时获取"我的位置"
- **⚡ 即时响应**：无需等待浏览器定位，直接跳转到地图应用
- **📍 精准定位**：地图应用使用自己的定位系统，更准确更及时
- **🚀 最佳体验**：用户移动时，导航起点自动更新为最新位置
- **🛡️ 隐私保护**：减少浏览器位置访问，保护用户隐私

### 4. 🏙️ 城市过滤功能

#### 自动城市识别
- 系统自动从地址信息中提取城市名称
- 支持识别国内各大城市
- 自动处理不同地址格式

#### 城市过滤操作
```
1. 当有多个城市的地点时，显示"🏙️ 全部城市"按钮
2. 点击按钮在以下选项间循环：
   全部城市 → 城市1 → 城市2 → ... → 全部城市
3. 选择特定城市时：
   - 只显示该城市的地点
   - 地图自动聚焦到该城市
   - 重新计算该城市内的路线
```

#### 智能管理
- **单城市时**：自动隐藏过滤按钮
- **删除地点后**：自动更新可用城市列表
- **当前城市被清空**：自动重置为"全部城市"

## 🎨 高级功能

### 1. 💾 方案管理系统

#### 保存方案
```
1. 点击右上角"📋 方案"按钮
2. 点击"保存当前方案"
3. 输入方案名称（如："北京三日游"）
4. 选择保存选项：
   - 保存为新方案
   - 覆盖现有方案
5. 点击"保存"
```

#### 加载方案
```
1. 点击"📋 方案" → "加载已保存方案"
2. 从方案列表中选择目标方案
3. 预览方案信息：
   - 方案名称
   - 地点数量
   - 创建时间
4. 点击"加载"
5. 选择加载方式：
   - 替换当前列表
   - 追加到当前列表
```

#### 方案对比
```
1. 同时打开多个方案
2. 查看不同方案的：
   - 地点列表
   - 总距离
   - 预计时间
3. 辅助决策选择最佳方案
```

### 2. 📤 导入导出功能

#### 数据导出
**方式一：JSON格式（推荐）**
```
1. 点击"📤 导出" → "导出JSON"
2. 导出完整数据，包括：
   - 游玩列表
   - 待定列表
   - 路线配置
   - 方案信息
3. 用于备份和跨设备同步
```

**方式二：HTML分享版**
```
1. 点击"📤 导出" → "导出分享版"
2. 生成包含地图的HTML文件
3. 可以分享给朋友或在其他设备查看
4. 包含静态地图和地点信息
```

#### 数据导入
```
1. 点击"📥 导入"
2. 选择之前导出的JSON文件
3. 选择导入方式：
   - 替换所有数据
   - 追加到现有数据
4. 点击"导入"完成
```

### 3. ⏳ 待定列表功能

#### 地点状态管理
- **游玩状态**：确定要去的地点，参与路线计算
- **待定状态**：考虑中的地点，不参与路线计算

#### 状态切换
```
1. 在地点操作菜单中点击"切换到待定"
2. 地点移动到待定列表
3. 不再显示在地图路线中
4. 可随时切换回游玩状态
```

#### 待定列表操作
- 查看所有待定地点
- 批量操作（添加到游玩列表、删除）
- 独立的地点信息管理

### 4. 🎛️ 地图控制功能

#### 地图显示控制
```
🧭 定位按钮：获取当前位置并在地图上显示
👁️ 隐藏标记：隐藏/显示地图上的地点标记
🛰️ 卫星地图：切换卫星视图和普通地图视图
🏷️ 地点名称：显示/隐藏地图上的地点名称标签
⏳ 待定地点：显示/隐藏待定列表的地点标记
```

#### 地图视图管理
- **单点定位**：点击"📍 定位"聚焦单个地点
- **总览恢复**：点击"🗺️ 恢复总地图"查看所有地点
- **自适应缩放**：根据地点分布自动调整地图缩放级别

## 💡 使用技巧

### 搜索优化技巧

1. **精确搜索**
   ```
   ✅ 好的搜索：北京故宫博物院
   ❌ 模糊搜索：故宫
   ```

2. **类型搜索**
   ```
   搜索 "北京 博物馆" 获得北京地区所有博物馆
   搜索 "上海 公园" 获得上海地区所有公园
   ```

3. **组合搜索**
   ```
   地点名 + 城市名：天安门 北京
   类型 + 区域：餐厅 朝阳区
   ```

### 路线规划技巧

1. **合理排序原则**
   - 按地理位置就近原则排列
   - 考虑开放时间安排顺序
   - 避免重复路径

2. **优化使用时机**
   ```
   ✅ 适合优化：3个以上地点且分布较分散
   ❌ 不必优化：地点较少或已经按地理位置排列
   ```

3. **时间预算参考**
   - 预计时间作为参考，实际留出10-20%余量
   - 考虑停车、步行、游玩时间
   - 高峰时段适当增加时间预算

### 导航选择策略

1. **国内旅行**
   ```
   首选：高德地图导航
   优势：路况准确、更新及时、功能本土化
   ```

2. **海外旅行**
   ```
   首选：Google 地图导航
   优势：全球覆盖、多语言支持、数据准确
   ```

3. **混合使用**
   ```
   可以为不同路线段选择不同导航平台
   例如：市内使用高德，跨境使用Google
   ```

### 数据管理技巧

1. **定期备份**
   ```
   建议每制定完一个方案就导出备份
   使用JSON格式保存完整数据
   ```

2. **方案分类**
   ```
   按时间分类：2024年春季游、暑假旅行
   按地区分类：华东游、西北游
   按类型分类：文化游、自然风光游
   ```

3. **多设备同步**
   ```
   在设备A导出JSON → 传输到设备B → 导入JSON
   实现跨设备数据同步
   ```

## 🔧 故障排除

### 地图相关问题

**Q: 地图无法加载，显示空白**
```
A: 检查项目：
1. 是否已配置正确的API密钥
2. 网络连接是否正常
3. API密钥是否有效且未超出配额
4. 浏览器是否支持JavaScript
```

**Q: 搜索功能不工作**
```
A: 解决方案：
1. 确认已启用Places API（Google Maps）
2. 检查API密钥权限设置
3. 尝试使用演示模式进行基础搜索
```

**Q: 距离计算显示"直线距离"**
```
A: 说明：
1. 这是API不可用时的降级模式
2. 检查Distance Matrix API是否已启用
3. 确认API配额是否充足
```

### API配置问题

**Q: Google Maps API提示计费问题**
```
A: 解决步骤：
1. 在Google Cloud Console中设置计费账户
2. 启用"Maps JavaScript API"等必需服务
3. 设置每日配额限制控制成本
4. 正常使用通常在免费额度内
```

**Q: 高德地图API报错**
```
A: 检查项目：
1. 确认应用类型选择为"Web端(JS API)"
2. 检查域名白名单设置
3. 确认服务平台勾选正确
```

### 功能使用问题

**Q: 拖拽排序不生效**
```
A: 可能原因：
1. 浏览器不支持拖拽API
2. 点击位置不在拖拽区域
3. 尝试使用现代浏览器（Chrome、Firefox等）
```

**Q: 导出功能无响应**
```
A: 解决方法：
1. 检查浏览器是否阻止文件下载
2. 尝试右键"另存为"
3. 清除浏览器缓存后重试
```

**Q: 数据导入失败**
```
A: 检查文件：
1. 确认文件格式为JSON
2. 文件未损坏且格式正确
3. 文件大小在合理范围内
```

### 性能优化建议

**Q: 应用运行速度慢**
```
A: 优化方法：
1. 减少同时显示的地点数量
2. 避免频繁重复的API调用
3. 定期清理浏览器缓存
4. 使用稳定的网络连接
```

## 🎯 最佳实践

### 规划前准备

1. **明确行程目标**
   - 确定旅行天数和预算
   - 了解目的地基本信息
   - 列出必去和可选地点

2. **选择合适的API**
   - 国内旅行优先选择高德地图
   - 海外旅行选择Google Maps
   - 根据使用频率选择免费或付费套餐

### 制定行程

1. **地点收集阶段**
   ```
   使用搜索功能收集所有可能的地点
   全部添加到待定列表
   不要急于确定最终行程
   ```

2. **筛选优化阶段**
   ```
   从待定列表中选择必去地点
   添加到游玩列表
   使用路线优化功能
   检查时间和距离是否合理
   ```

3. **细化调整阶段**
   ```
   根据开放时间调整顺序
   考虑用餐、休息时间
   预留机动时间
   ```

### 行程执行

1. **出发前**
   - 导出行程备份到手机
   - 检查地点营业时间
   - 下载离线地图（如需要）

2. **行程中**
   - 使用导航功能规划路线
   - 及时更新实际情况
   - 记录游玩体验

3. **行程后**
   - 保存最终版本作为模板
   - 分享行程给朋友
   - 为下次旅行做参考

### 数据管理

1. **命名规范**
   ```
   方案命名：城市+时间+主题
   例如：北京_2024春_文化游
   ```

2. **定期整理**
   - 删除不需要的临时方案
   - 导出重要方案进行备份
   - 整理收藏的地点信息

3. **分享协作**
   - 使用HTML导出功能分享给同行者
   - 协作编辑同一个行程方案
   - 收集反馈持续优化

查看下方[版本管理系统说明](#-版本管理系统说明)

## 📋 版本管理系统说明

### 🎯 概述

本项目使用**手动维护**的版本更新记录系统，自动生成版本号和显示版本历史。

### 🔧 版本号规则

**格式**: `major.minor.patch` (例: 1.6.2)

- **major**: 主版本号 (固定为 1)
- **minor**: 次版本号 (feature 类型更新时 +1)
- **patch**: 修订版本号 (fix/optimize 类型更新时 +1)

### 📝 如何添加新版本

#### 1. 找到更新记录位置
文件: `script.js` → `generateVersionHistory()` 方法 → `updateCommits` 数组

#### 2. 添加新记录格式

**单项更新**:
```javascript
{ updates: [{ message: '新增XXX功能', type: 'feature' }] }
```

**多项更新**:
```javascript
{
    updates: [
        { message: '新增XXX功能', type: 'feature' },
        { message: '修复XXX问题', type: 'fix' },
        { message: '优化XXX体验', type: 'optimize' }
    ]
}
```

#### 3. 更新类型说明

| 类型 | 说明 | 版本影响 | 显示标签 |
|------|------|----------|----------|
| `feature` | 新增功能 | minor +1, patch 重置为 0 | 🟢 新增 |
| `fix` | 修复问题 | patch +1 | 🔴 修复 |
| `optimize` | 优化改进 | patch +1 | 🟡 优化 |

#### 4. 添加步骤

1. 在 `updateCommits` 数组**末尾**添加新记录
2. 保存文件
3. 刷新页面查看效果

### 🚀 版本号自动计算

#### 优先级规则
- 如果更新中包含 `feature` → minor +1, patch 重置
- 如果只有 `fix` 或 `optimize` → patch +1

#### 示例计算
```
当前版本: 1.5.3

添加: { updates: [{ message: '新增导出功能', type: 'feature' }] }
结果版本: 1.6.0

添加: { updates: [{ message: '修复按钮问题', type: 'fix' }] }  
结果版本: 1.6.1
```

### 💡 最佳实践

1. **按时间顺序添加**: 新记录放在数组末尾
2. **描述清晰具体**: 说明具体改动内容
3. **类型选择准确**: 根据实际影响选择合适类型
4. **分组相关更新**: 相关的多个更改可放在一个版本中

### 🎨 显示效果

- **当前版本**: 自动显示最新版本号
- **版本历史**: 按时间倒序显示所有更新
- **多项更新**: 显示 "X项更新" 标识
- **类型标签**: 不同颜色区分更新类型

### 📍 注意事项

⚠️ **重要**: 本系统为手动维护，**不会**自动从 git 提交记录获取信息
✅ **优势**: 完全可控，可以精确控制版本号和显示内容
🔄 **更新**: 添加新记录后需要刷新页面才能看到效果

---

## 📞 技术支持

如果您在使用过程中遇到问题：

1. **查看常见问题**：本教程的故障排除章节
2. **检查浏览器控制台**：F12 → Console查看错误信息
3. **提交Issue**：[GitHub Issues](../../issues)

---

**🎉 希望这份教程能帮助您更好地使用17旅游规划助手，享受愉快的旅行规划体验！** 🗺️✈️🎯 